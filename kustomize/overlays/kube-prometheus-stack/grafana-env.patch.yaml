- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GENERIC_OAUTH_ENABLED
    value: "true"

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GENERIC_OAUTH_ALLOW_SIGN_UP
    value: "true"

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GENERIC_OAUTH_NAME
    value: "Auth0"

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GENERIC_OAUTH_CLIENT_ID
    valueFrom:
      secretKeyRef:
        name: oauth-credentials
        key: auth_auth0_client_id

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GENERIC_OAUTH_CLIENT_SECRET
    valueFrom:
      secretKeyRef:
        name: oauth-credentials
        key: auth_auth0_client_secret

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GENERIC_OAUTH_SCOPES
    value: "openid profile email"

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GENERIC_OAUTH_AUTH_URL
    value: "https://cedi.eu.auth0.com/authorize"

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GENERIC_OAUTH_TOKEN_URL
    value: "https://cedi.eu.auth0.com/oauth/token"

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GENERIC_OAUTH_API_URL
    value: "https://cedi.eu.auth0.com/userinfo"

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GENERIC_OAUTH_USE_PKCE
    value: "true"

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GENERIC_OAUTH_ROLE_ATTRIBUTE_PATH
    value: "contains(name, 'cedi') && 'Admin' || contains(user_metadata.roles[*], 'admin') && 'Admin' || contains(user_metadata.roles[*], 'editor') && 'Editor' || 'Viewer'" # TODO: fixme...

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GENERIC_OAUTH_ALLOW_ASSIGN_GRAFANA_ADMIN
    value: "true"

## GitHub Auth

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GITHUB_ENABLED
    value: "true"

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GITHUB_ALLOW_SIGN_UP
    value: "true"

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GITHUB_SCOPES
    value: user:email,read:org

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GITHUB_AUTH_URL
    value: https://github.com/login/oauth/authorize

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GITHUB_TOKEN_URL
    value: https://github.com/login/oauth/access_token

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GITHUB_API_URL
    value: https://api.github.com/user

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GITHUB_CLIENT_ID
    valueFrom:
      secretKeyRef:
        name: oauth-credentials
        key: auth_github_client_id

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GITHUB_CLIENT_SECRET
    valueFrom:
      secretKeyRef:
        name: oauth-credentials
        key: auth_github_client_secret

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GITHUB_ALLOWED_ORGANIZATIONS
    valueFrom:
      secretKeyRef:
        name: oauth-credentials
        key: auth_github_allowed_organizations

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_AUTH_GITHUB_TEAM_IDS
    valueFrom:
      secretKeyRef:
        name: oauth-credentials
        key: auth_github_team_ids

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_SERVER_ROOT_URL
    value: https://grafana.cedi.dev/

- op: add
  path: "/spec/template/spec/containers/2/env/-"
  value:
    name: GF_FEATURE_TOGGLES_ENABLE
    value: tempoSearch tempoBackendSearch
