apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: kube-system

bases:
  - ../../bases/hcloud-csi

patches:
  - target:
      kind: ClusterRole
      name: csi-csi-hcloud
      version: v1
    patch: |-
      - op: add
        path: "/rules/-"
        value:
          apiGroups:
            - ""
          resources:
            - nodes
          verbs:
            - create
            - get
            - list
            - watch
            - update
            - patch
            - delete
      - op: add
        path: "/rules/-"
        value:
          apiGroups:
            - ""
          resources:
            - csinodes
          verbs:
            - create
            - get
            - list
            - watch
            - update
            - patch
            - delete
      - op: add
        path: "/rules/-"
        value:
          apiGroups:
            - ""
          resources:
            - storageclasses
          verbs:
            - create
            - get
            - list
            - watch
            - update
            - patch
            - delete
      - op: add
        path: "/rules/-"
        value:
          apiGroups:
            - ""
          resources:
            - volumeattachments
          verbs:
            - create
            - get
            - list
            - watch
            - update
            - patch
            - delete
