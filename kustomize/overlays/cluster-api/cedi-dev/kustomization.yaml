apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: default

bases:
  - ../../../bases/cluster-api/

patchesJson6902:
  - target:
      kind: KubeadmConfigTemplate
      namespace: default
      name: worker-template-x86-taints
    path: kubeadm-config-template.patch.yaml

  - target:
      kind: KubeadmConfigTemplate
      namespace: default
      name: worker-template
    path: kubeadm-config-template.patch.yaml

  - target:
      kind: KubeadmControlPlane
      namespace: default
      name: cedi-dev-control-plane
    path: kubeadm-controlplane.patch.yaml

  - target:
      kind: MachineDeployment
      namespace: default
      name: worker-arm-fsn
    path: machine-deployment-arm.patch.yaml

  - target:
      kind: MachineDeployment
      namespace: default
      name: worker-arm-hel
    path: machine-deployment-arm.patch.yaml

  - target:
      kind: MachineDeployment
      namespace: default
      name: worker-arm-nbg
    path: machine-deployment-arm.patch.yaml

  - target:
      kind: MachineDeployment
      namespace: default
      name: worker-x86-nbg
    path: machine-deployment-x86.patch.yaml
  
  - target:
      kind: MachineDeployment
      namespace: default
      name: worker-arm-nbg
    patch: |-
      - op: replace
        path: "/spec/replicas"
        value: 1
      - op: replace
        path: "/metadata/annotations/cluster.x-k8s.io~1cluster-api-autoscaler-node-group-min-size"
        value: '1'
      - op: replace
        path: "/metadata/annotations/cluster.x-k8s.io~1cluster-api-autoscaler-node-group-max-size"
        value: '1'