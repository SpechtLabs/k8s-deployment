global:
  extraEnv:
    - name: OTLP_ENDPOINT
      value: "tempo-distributor.observability.svc.cluster.local:4318"
    - name: OTLP_INSECURE
      value: "true"

urlshortener:
  replicaCount: 1
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 80

  image:
    pullPolicy: Always
    tag: main

  podAnnotations:
    kubectl.kubernetes.io/default-container: urlshortener

  pdb:
    enabled: false
    minAvailable: 1

  ingress:
    enabled: true
    className: "nginx"
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
    hosts:
      - host: short.cedi.dev
        paths:
          - path: /
            pathType: ImplementationSpecific
    tls:
      - secretName: short-cedi-dev-tls
        hosts:
          - short.cedi.dev

  metrics:
    enabled: true
    serviceMonitor:
      enabled: true
      interval: 30s
    rules:
      enabled: false

apiServer:
  replicaCount: 1
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 5
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 80

  image:
    pullPolicy: Always
    tag: main

  podAnnotations:
    kubectl.kubernetes.io/default-container: urlshortener-api

  pdb:
    enabled: false
    minAvailable: 1

  ingress:
    enabled: true
    className: "nginx"
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
    hosts:
      - host: api.short.cedi.dev
        paths:
          - path: /
            pathType: ImplementationSpecific
    tls:
      - secretName: api-short-cedi-dev-tls
        hosts:
          - api.short.cedi.dev

  metrics:
    enabled: true
    serviceMonitor:
      enabled: true
      interval: 30s
    rules:
      enabled: false

dashboard:
  replicaCount: 1
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 5
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 80

  image:
    pullPolicy: Always
    tag: main

  podAnnotations:
    kubectl.kubernetes.io/default-container: urlshortener-ui

  env:
    - name: REDIRECT_URL
      value: https://dash.short.cedi.dev/oauth/redirect
    - name: HOSTNAME
      value: dash.short.cedi.dev
    - name: SHORTLINK_URL
      value: https://ccl.pw

  extraEnvFrom:
    - secretRef:
        name: urlshortener-oidc

  pdb:
    enabled: false
    minAvailable: 1

  ingress:
    enabled: true
    className: "nginx"
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
    hosts:
      - host: dash.short.cedi.dev
        paths:
          - path: /
            pathType: ImplementationSpecific
    tls:
      - secretName: dash-short-cedi-dev-tls
        hosts:
          - dash.short.cedi.dev

  metrics:
    enabled: false
    serviceMonitor:
      enabled: false
      interval: 30s
    rules:
      enabled: false