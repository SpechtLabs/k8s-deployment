global:
  extraEnv:
    - name: OTLP_ENDPOINT
      value: "http://tempo-distributor.observability:4318"

urlshortener:
  replicaCount: 1
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 80

  image:
    pullPolicy: Always
    tag: main

  podAnnotations:
    kubectl.kubernetes.io/default-container: urlshortener

  resources:
    limits:
      cpu: 500m
      memory: 128Mi
    requests:
      cpu: 10m
      memory: 64Mi

  pdb:
    enabled: false
    minAvailable: 1

  ingress:
    enabled: true
    className: "nginx"
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
    hosts:
      - host: short.cedi.dev
        paths:
          - path: /
            pathType: ImplementationSpecific
    tls:
      - secretName: short-cedi-dev-tls
        hosts:
          - short.cedi.dev

  metrics:
    enabled: true
    serviceMonitor:
      enabled: true
      interval: 30s
    rules:
      enabled: false

apiServer:
  replicaCount: 1
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 5
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 80

  image:
    pullPolicy: Always
    tag: main

  podAnnotations:
    kubectl.kubernetes.io/default-container: urlshortener-api

  resources:
    limits:
      cpu: 500m
      memory: 128Mi
    requests:
      cpu: 10m
      memory: 64Mi

  pdb:
    enabled: false
    minAvailable: 1

  ingress:
    enabled: true
    className: "nginx"
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
      nginx.ingress.kubernetes.io/auth-signin: https://auth-shortlink.cedi.dev/oauth2/start
      nginx.ingress.kubernetes.io/auth-url: http://oauth2-proxy.oauth2-proxy-shortlink-api.svc.cluster.local/oauth2/auth
    hosts:
      - host: api.short.cedi.dev
        paths:
          - path: /
            pathType: ImplementationSpecific
    tls:
      - secretName: api-short-cedi-dev-tls
        hosts:
          - api.short.cedi.dev

  metrics:
    enabled: true
    serviceMonitor:
      enabled: true
      interval: 30s
    rules:
      enabled: false
