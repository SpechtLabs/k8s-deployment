apiVersion: monitoring.grafana.com/v1alpha1
kind: MetricsInstance
metadata:
  name: metrics
  namespace: observability
  labels:
    agent: grafana-agent-metrics
spec:
  remoteWrite:
    - url: http://mimir-nginx.observability.svc.cluster.local/api/v1/push
      headers:
        X-Scope-OrgID: cedi-dev

  # Supply an empty namespace selector to look in all namespaces. Remove
  # this to only look in the same namespace as the MetricsInstance CR
  serviceMonitorNamespaceSelector: {}
  serviceMonitorSelector: {}
    # matchLabels:
    #   instance: primary

  # Supply an empty namespace selector to look in all namespaces. Remove
  # this to only look in the same namespace as the MetricsInstance CR.
  podMonitorNamespaceSelector: {}
  podMonitorSelector: {}
    # matchLabels:
    #   instance: primary

  # Supply an empty namespace selector to look in all namespaces. Remove
  # this to only look in the same namespace as the MetricsInstance CR.
  probeNamespaceSelector: {}
  probeSelector: {}
    # matchLabels:
    #   instance: primary

  additionalScrapeConfigs:
    name: extra-jobs
    key: jobs.yaml