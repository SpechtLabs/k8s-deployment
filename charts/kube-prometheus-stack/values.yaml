kube-prometheus-stack:
  namespaceOverride: "monitoring"
  kubeTargetVersionOverride: "1.20.6"
  fullnameOverride: "prom-stack"
  alertmanager:
    podDisruptionBudget:
      enabled: true
    alertmanagerSpec:
      externalUrl: "https://alertmgr.av0.de"
      replicas: 1
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchLabels:
                  app: alertmanager
              topologyKey: kubernetes.io/hostname
            weight: 100
      storage:
        volumeClaimTemplate:
          spec:
            resources:
              requests:
                storage: 1Gi
      configSecret: alertmanager
      useExistingSecret: true
  kubelet:
    serviceMonitor:
      resourcePath: "/metrics/resource"
  kubeControllerManager:
    serviceMonitor:
      https: true
  kubeEtcd:
    serviceMonitor:
      scheme: https
  kubeProxy:
    serviceMonitor:
      https: true
  kubeScheduler:
    serviceMonitor:
      https: true
  prometheus:
    prometheusSpec:
      externalUrl: "https://prometheus.av0.de"
      replicas: 1
      retention: 30d
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchLabels:
                  app: prometheus
              topologyKey: kubernetes.io/hostname
            weight: 100
      resources:
        limits:
          cpu: "2"
          memory: 2Gi
        requests:
          cpu: 100m
          memory: 64Mi
      storageSpec:
        volumeClaimTemplate:
          spec:
            resources:
              requests:
                storage: 64Gi
